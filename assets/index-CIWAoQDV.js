(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();function T(l){let e=l.length;for(;e!=0;){let t=Math.floor(Math.random()*e);e--,[l[e],l[t]]=[l[t],l[e]]}}class b{constructor(){this.element=document.createElement("div"),this.hasMine=!1,this.hasFlag=!1,this.isRevealed=!1,this.adjacentMines=0}setMine(){this.hasMine=!0,this.element.dataset.mine=!0,this.element.classList.add("mine")}reveal(){return this.isRevealed?!1:(this.element.classList.add("revealed"),this.isRevealed=!0,this.adjacentMines>0&&!this.hasMine&&(this.element.innerText=`${this.adjacentMines}`),!this.hasMine)}toggleFlag(){this.hasFlag?(this.element.classList.remove("flag"),this.hasFlag=!1):(this.element.classList.add("flag"),this.hasFlag=!0)}}class z{constructor(e,t){this.size=e,this.difficult=t,this.cells=[],this.element=document.getElementById("board"),this.maxMines=this.gameDifficulty(),this.isGameOver=!1,this.filaRelativa=[-1,-1,-1,0,0,1,1,1],this.colRelativa=[-1,0,1,-1,1,-1,0,1],this.safeCells=this.size*this.size-this.maxMines,this.revealedCount=0}generar(){this.#e(),this.element.innerText="";for(let t=0;t<this.size*this.size;t++){const s=new b;s.element.classList.add("cell"),this.cells.push(s),this.element.appendChild(s.element)}let e=[];for(let t=0;t<this.cells.length;t++)e.push(t);T(e);for(let t=0;t<this.maxMines;t++){let s=e[t];this.cells[s].setMine(),this.cells[s].hasMine=!0}this.#t()}revealAllMines(){this.cells.forEach(e=>{e.hasMine&&e.reveal()})}#e(){this.element.classList.contains("grid-cols-8")?this.element.classList.replace("grid-cols-8",`grid-cols-${this.size}`):this.element.classList.contains("grid-cols-16")?this.element.classList.replace("grid-cols-16",`grid-cols-${this.size}`):this.element.classList.contains("grid-cols-32")?this.element.classList.replace("grid-cols-32",`grid-cols-${this.size}`):this.element.classList.add(`grid-cols-${this.size}`)}#t(){this.cells.forEach(e=>{e.adjacentMines=0;let t=this.cells.indexOf(e),s=Math.floor(t/this.size),i=t%this.size;for(let n=0;n<8;n++){let a=s+this.filaRelativa[n],o=i+this.colRelativa[n];if(a>=0&&a<this.size&&o>=0&&o<this.size){const c=a*this.size+o;this.cells[c].hasMine&&(e.adjacentMines+=1)}}})}revealEmptyNeighbors(e){let t=this.cells.indexOf(e),s=Math.floor(t/this.size),i=t%this.size;for(let n=0;n<8;n++){let a=s+this.filaRelativa[n],o=i+this.colRelativa[n];if(a>=0&&a<this.size&&o>=0&&o<this.size){const c=a*this.size+o;this.cells[c].isRevealed||(this.cells[c].reveal()&&(this.revealedCount+=1,this.checkWin()),this.cells[c].adjacentMines===0&&this.revealEmptyNeighbors(this.cells[c]))}}}checkWin(){if(this.revealedCount===this.safeCells)return this.isGameOver=!0,this.isGameOver}reset(){this.element.innerText=""}gameDifficulty(){if(this.difficult==="easy")return Math.round(this.size*this.size*.15);if(this.difficult==="medium")return Math.round(this.size*this.size*.25);if(this.difficult==="hard")return Math.round(this.size*this.size*.3)}}class E{constructor(e){this.seconds=0,this.mins=0,this.hours=0,this.startTimer="",this.element=e}timer(){this.seconds+=1,this.seconds===60&&(this.mins+=1,this.seconds=0,this.mins===60&&(this.hours+=1,this.mins=0,this.seconds=0))}start(){this.startTimer=setInterval(()=>{this.timer(),this.paintTimer()},1e3)}pause(){clearInterval(this.startTimer)}stop(){clearInterval(this.startTimer),this.seconds=0,this.mins=0,this.hours=0,this.paintTimer()}paintTimer(){let e=String(this.hours).padStart(2,"0"),t=String(this.mins).padStart(2,"0"),s=String(this.seconds).padStart(2,"0");this.element.innerText=`${e}:${t}:${s}`}}function u(l,e,t=!1){const s=document.querySelector("main"),i=document.createElement("div");i.classList.add("popup","absolute","top-40","left-20","2xl:top-100","2xl:left-180","xl:left-110","md:left-70","lg:left-100","lg:top-100","bg-gray-800","flex","flex-col","items-center","justify-center","rounded","xl:w-[500px]","gap-2","p-3");const n=document.createElement("h2");n.classList.add("text-3xl"),t?n.innerText="¡Has ganado!":n.innerText="¡Has perdido!";const a=document.createElement("p");a.innerText=`Tiempo de Juego: ${l}`;const o=document.createElement("p");let c=localStorage.getItem(e);c===null?o.innerText="Mejor tiempo: -":o.innerText=`Mejor tiempo: ${c}`;const f=document.createElement("button");f.classList.add("rounded-ml-2","bg-gray-700","rounded","p-1"),f.innerText="Restart",f.addEventListener("click",M=>{M.preventDefault(),location.reload()}),i.appendChild(n),i.appendChild(a),i.appendChild(o),i.appendChild(f),s.appendChild(i)}function x(l){const[e,t,s]=l.split(":").map(Number);return e*3600+t+60+s}function p(l,e){const t=localStorage.getItem(l);t?x(e)<x(t.time)&&localStorage.setItem(l,e):localStorage.setItem(l,e)}const g=document.getElementById("start"),m=document.getElementById("reset");m.disabled=!0;const v=document.getElementById("board-size"),L=document.getElementById("difficult"),d=document.getElementById("time"),h=new E(d);let r;g.addEventListener("click",l=>{let e=v.value,t=L.value;if(l.preventDefault(),r=new z(e,t),window.innerWidth<800&&e>=32){const s=document.getElementById("board");s.innerText="Ese tamaño de tablero solo está disponible en pantallas grandes"}else r.generar();h.start(),r.cells.forEach(s=>{s.element.addEventListener("click",()=>{r.isGameOver||s.hasFlag||(s.hasMine?(r.revealAllMines(),setTimeout(()=>{u(d.innerText,e+t),h.pause(),m.disabled=!0},500),r.isGameOver=!0):s.adjacentMines===0?(s.reveal()&&(r.revealedCount+=1,r.checkWin()&&(u(d.innerText,e,!0),h.pause(),p(e+t,d.innerText))),r.revealEmptyNeighbors(s),r.checkWin()&&(u(d.innerText,e,!0),h.pause(),p(e+t,d.innerText))):s.reveal()&&(r.revealedCount+=1,r.checkWin()&&(u(d.innerText,e,!0),h.pause(),p(e+t,d.innerText))))}),s.element.addEventListener("contextmenu",i=>{i.preventDefault(),!s.isRevealed&&s.toggleFlag()})}),g.disabled=!0,v.disabled=!0,m.disabled=!1});m.addEventListener("click",l=>{l.preventDefault(),h.stop(),r.reset(),g.disabled=!1,v.disabled=!1});
